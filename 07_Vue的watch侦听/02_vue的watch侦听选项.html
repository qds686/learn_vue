<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <div id="app">
    <h2>{{ info.name }}</h2>
    <button @click="changeInfo">修改info</button>
  </div>

  <script src="../lib/vue.js"></script>
  <script>
    const app = Vue.createApp({
      data() {
        return {
          info: { name: "hezi", age: 18 }
        }
      },
      methods: {
        changeInfo() {
          // 1.创建一个新对象，赋值给info
          // this.info = { name: 'kobe' };

          // 2.直接修改原对象的某一个属性
          this.info.name = 'kobe';
        }
      },
      watch: {
        // 1.默认watch监听不会进行深度监听
        // info(newValue, oldValue) {
        //   // 这里监听不到，需要深度监听
        //   console.log('侦听到info改变：', newValue, oldValue);
        // }

        // 2.进行深度监听
        info: {
          handler(newValue, oldValue) {
            /* 
            如果第一次就渲染，oldValue是undefined，newValue是proxy代理对象
              侦听到info改变： Proxy(Object) {name: 'hezi', age: 18} undefined false
            第二次渲染的时候两个都是proxy代理对象
              侦听到info改变： Proxy {name: 'kobe', age: 18} Proxy {name: 'kobe', age: 18} true
            */
            console.log('侦听到info改变：', newValue, oldValue);
            console.log(newValue === oldValue); // true
          },
          // 对info进行深度监听
          deep: true,
          // 默认第一次渲染的时候不执行watch，需要第一次渲染就执行需要配置
          immediate: true
        },

        // 这种方式Vue3中没有提到，Vue2文档中有提到的监听对象的属性
        "info.name": function (newValue, oldValue) {
          // 监听到name改变： kobe hezi
          console.log('监听到name改变：', newValue, oldValue);
        },

        // watch侦听器的其他写法，用的较少
        /* f: [
          // 这个字符串表示监听的方法写在了methods中
          "handle1",
          // 正常语法糖的形式
          function handle2(newValue, oldValue) {
            console.log("handle2 triggered");
          },
          // 需要配置的写法
          {
            handler: function handle3(newValue, oldValue) {
              console.log("handle3 triggered");
            }
          }
        ] */
      }
    });
    app.mount("#app");
  </script>
</body>

</html>